<form [formGroup]="form" (ngSubmit)="submitForm()">
  <ng-container *ngTemplateOutlet="formElement; context: { config: getFormElementContext('name.first') }"></ng-container>

  <ng-container *ngTemplateOutlet="formElement; context: { config: getFormElementContext('name.last') }"></ng-container>

  <div class="form-group row">
    <label class="col-sm-4 col-form-label col-form-label-sm">Phone</label>
    <div class="col-sm-8">
      <ng-container *ngFor="let control of form.get('phone').controls; let first = first">
        <input class="form-control form-control-sm mb-2" type="text" [formControl]="control">
      </ng-container>

      <button type="button" class="btn btn-sm btn-link" (click)="addPhone()">Add phone</button>
    </div>
  </div>

  <div class="text-right">
    <button type="submit" class="btn btn-sm btn-primary">Submit</button>
  </div>
</form>

<ng-template #formElement let-config="config">
  <div class="form-group row">
    <label [attr.for]="config.name" class="col-sm-4 col-form-label col-form-label-sm">{{config.label}}</label>
    <div class="col-sm-8">
      <input [attr.id]="config.name" class="form-control form-control-sm" [formControl]="config.control">
    </div>
  </div>
</ng-template>
